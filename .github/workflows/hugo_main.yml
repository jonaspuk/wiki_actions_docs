name: Hugo
on: workflow_dispatch
# schedule:
#   # * is a special character in YAML so you have to quote this string, shortest is 5 minutes
#   - cron:  '5 * * * *'
jobs:
  build:
    runs-on: ubuntu-latest
    steps:
    - name: Checkout Wiki
      uses: actions/checkout@v2
      with:
        fetch-depth: 0
        repository: 'jonaspuk/wiki_actions_docs.wiki'
        path: 'wiki'
    - name: Checkout Main Repo
      uses: actions/checkout@v2
      with:
        path: 'main'
    - name: Sync repo's
      run: rsync -avz --exclude '.git' wiki/ main/docs
    - name: Print main repo contents
      run: ls -la main/docs && ls -la wiki
    - run: |
        cd main
        date > /tmp/generated.txt
        git config user.name github-actions
        git config user.email github-actions@github.com
        git add .
        git commit -m "$(cat /tmp/generated.txt)"
        git push
# push:
#   runs-on: ubuntu-latest
#   needs: build
#   steps:
#   - name: Checkout wiki repo
#   - uses: actions/checkout@v2
#     with:
#       repository: 'jonaspuk/wiki_actions_docs.wiki'
#       path: '.wiki'
#   - name: 
#   - run: |
#       date > /tmp/generated.txt
#       git config user.name github-actions
#       git config user.email github-actions@github.com
#       git add main/docs/*
#       git commit -m "$(cat /tmp/generated.txt)"
#       git push